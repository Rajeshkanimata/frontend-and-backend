<!DOCTYPE html>
<html>
  <head>
    <title>3-Tier User App</title>
    <style>
      body { font-family: Arial; background: #f4f4f4; padding: 30px; }
      h1 { color: #333; }
      input { margin: 5px; padding: 8px; }
      button { padding: 8px 16px; background: #0078ff; color: white; border: none; border-radius: 5px; cursor: pointer; }
      table { border-collapse: collapse; margin-top: 20px; width: 50%; background: white; }
      td, th { border: 1px solid #ddd; padding: 10px; text-align: left; }
    </style>
  </head>
  <body>
    <h1>User Management App</h1>
    <div>
      <input id="name" placeholder="Name" />
      <input id="email" placeholder="Email" />
      <button onclick="addUser()">Add User</button>
    </div>
    <h3>All Users:</h3>
    <table id="usersTable">
      <tr><th>ID</th><th>Name</th><th>Email</th></tr>
    </table>

    <script>
      async function fetchUsers() {
        const res = await fetch("/api/users");
        const users = await res.json();
        const table = document.getElementById("usersTable");
        table.innerHTML = "<tr><th>ID</th><th>Name</th><th>Email</th></tr>";
        users.forEach(u => {
          table.innerHTML += `<tr><td>${u.id}</td><td>${u.name}</td><td>${u.email}</td></tr>`;
        });
      }

      async function addUser() {
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        await fetch("/api/users", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email })
        });
        document.getElementById("name").value = "";
        document.getElementById("email").value = "";
        fetchUsers();
      }

      fetchUsers();
    </script>
  </body>
</html>
